To check for accounts with non-expiring passwords in the Domain Admins group on Windows clients, you can use PowerShell. Hereâ€™s a step-by-step guide:

Open PowerShell as Administrator:
Press Win + X and select Windows PowerShell (Admin).
Import the Active Directory Module:
Ensure the Active Directory module is available. If it's not, you might need to install the Remote Server Administration Tools (RSAT).
powershell

Copy
Import-Module ActiveDirectory
Get Members of the Domain Admins Group:
Use the following command to list all members of the Domain Admins group.
powershell

Copy
$domainAdmins = Get-ADGroupMember -Identity "Domain Admins"
Check for Non-Expiring Passwords:
Iterate over each account and check if the password never expires.
powershell

Copy
$nonExpiringAccounts = @()

foreach ($admin in $domainAdmins) {
    $user = Get-ADUser -Identity $admin.SamAccountName -Properties PasswordNeverExpires
    if ($user.PasswordNeverExpires) {
        $nonExpiringAccounts += $user
    }
}

$nonExpiringAccounts | Select-Object SamAccountName, Name
Count and Display Results:
Display the count and details of accounts with non-expiring passwords.
powershell

Copy
$count = $nonExpiringAccounts.Count
Write-Output "Number of accounts with non-expiring passwords: $count"
$nonExpiringAccounts | Format-Table SamAccountName, Name
This script will output the number of accounts with non-expiring passwords and list their usernames and names. Adjust accordingly if you have specific requirements for the output format.

https://poe.com/s/PvM5DUaJxgO09E7onh5F
